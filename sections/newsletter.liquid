{{ 'newsletter.css' | asset_url | stylesheet_tag }}
{% render 'section-style' %}

<style>
  #shopify-section-{{ section.id }} {
    --heading-color: {{ section.settings.heading_color | color_extract: 'red' }}, {{ section.settings.heading_color | color_extract: 'green' }}, {{ section.settings.heading_color | color_extract: 'blue' }};
    --color-body: {{ section.settings.text_color | color_extract: 'red' }}, {{ section.settings.text_color | color_extract: 'green' }}, {{ section.settings.text_color | color_extract: 'blue' }};
    --primary-button-background: {{ section.settings.button_background | color_extract: 'red' }}, {{ section.settings.button_background | color_extract: 'green' }}, {{ section.settings.button_background | color_extract: 'blue' }};
    --primary-button-text-color: {{ section.settings.button_color | color_extract: 'red' }}, {{ section.settings.button_color | color_extract: 'green' }}, {{ section.settings.button_color | color_extract: 'blue' }};
    --section-block-background: {{ section.settings.section_background | color_extract: 'red' }}, {{ section.settings.section_background | color_extract: 'green' }}, {{ section.settings.section_background | color_extract: 'blue' }};
    --bg-btn-hover: {{ section.settings.background_button_hover }};
  }
  #shopify-section-{{ section.id }} {
    background-color: rgb(var(--section-block-background));
  }
  [dir=ltr] .wp-newsletter-input .input__label {
    --form-input-field-height: 52px;
  }
  #shopify-section-{{ section.id }} .sp-heading {
    line-height: 1.3;
    font-weight: 600;
  }
  #shopify-section-{{ section.id }} .newsletter .input__field {
    border-radius: 0;
  }
  #shopify-section-{{ section.id }} .ap-text-loaderbutton {
    flex-direction: row;
    justify-content: center;
  }

  {%- for block in section.blocks -%}
  #shopify-section-{{ section.id }} .newsletter .input__field {
    background-color: {{ block.settings.bg_input }};
  }
  #shopify-section-{{ section.id }} .input__label {
    color: {{ block.settings.color_input }};
    background-color: {{ block.settings.bg_input }};
  }
  {%- endfor -%}
</style>

<section class="section section--flush newsletter">
  <ap-newsletter reveal-on-scroll="" class="ap-newsletter--cover ap-object-loaded">
    <div class="ap-newsletter">
      <div class="{{ section.settings.setwidthout }}">
        <div class="newsletter-content ap-newsletter__content ap-newsletter__content--tight">
          {%- for block in section.blocks -%}
            {%- case block.type -%}
              {%- when '@app' -%}
                {% render block %}
              {%- when 'heading' -%}
                <div class="newsletter-text">
                  <h2 class="heading heading--small newsletter-title" reveal="" {{ block.shopify_attributes }}>{{ block.settings.heading }}</h2>
                  <div reveal="" class="description-newsletter">
                    {{ block.settings.description }}
                  </div>
                </div>

              {%- when 'paragraph' -%}
                {{ block.settings.text }}

              {%- when 'email_form' -%}
                <div style="background-color: {{ block.settings.bg_newsletter }}" class="newsletter-wrapper w-100 text-{{ block.settings.text_align }}">
                  {% if block.settings.heading != blank %}
                    <h2 style="color: {{ block.settings.color_heading }}" class="heading h2" reveal="">{{ block.settings.heading }}</h2>
                  {% endif %}
                  {% if block.settings.description != blank %}
                    <div style="color: {{ block.settings.color_des }}" reveal="" class="mb-20">
                      {{ block.settings.description }}
                    </div>
                  {% endif %}
                  <div class="email-form" reveal="" {{ block.shopify_attributes }}>
                    {% form 'customer', class: 'newsletter-form' %}
                      <input type="hidden" name="form_type" value="customer">
                      <input type="hidden" name="utf8" value="âœ“">
                      <input type="hidden" name="contact[tags]" value="newsletter">
                      <input type="hidden" name="contact[context]" value="newsletter-{{ section.id }}">
    
                      <div class="wp-newsletter-input">
                        <div class="input-row">
                          <div class="input">
                            <input type="email" id="newsletter[{{ section.id }}][contact][email]" name="contact[email]" class="input__field" required="">
                            <label for="newsletter[{{ section.id }}][contact][email]" class="input__label">
                              {{ block.settings.text_input }}
                            </label>
                          </div>
                        </div>
                        <div class="input input-button">
                          <button type="submit" is="loader-button" class="button button--primary">
                            <span class="ap-text-loaderbutton">
                              {{ block.settings.text_button }}
                            </span>
                            <span class="ap-loader-loaderbutton" hidden="">
                              <div class="spinner">
                                <svg focusable="false" width="24" height="24" class="icon icon--spinner" viewBox="25 25 50 50">
                                  <circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="5"></circle>
                                </svg>
                              </div>
                            </span>
                          </button>
                        </div>
                      </div>
    
                      {%- if form.errors -%}
                        <small class="newsletter-form__message form__message" id="Newsletter-error--{{ section.id }}">{% render 'icon-error' %}{{ form.errors.translated_fields['email'] | capitalize }} {{ form.errors.messages['email'] }}</small>
                      {%- endif -%}
                      {%- if form.posted_successfully? -%}
                        <div class="form__banner banner banner--success">
                          <span class="banner__ribbon">
                            <svg focusable="false" width="18" height="26" class="icon icon--form-success   " viewBox="0 0 18 26">
                              <circle fill="none" cx="9" cy="13" r="8" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></circle>
                              <path fill="none" d="M5 13l3 3 5-6" stroke="currentColor" stroke-width="1.5"></path>
                            </svg>
                          </span>
                          <p class="banner__content">{{ 'newsletter.success' | t }}</p>
                        </div>
                      {%- endif -%}
    
                    {% endform %}
                  </div>
                </div>
                
              {%- when 'image-child' -%}
                <div reveal="" class="newsletter-image-child">
                  {% if block.settings.image_child != blank %}
                      <img class="newsletter-list-image" reveal="" loading="lazy" 
                      sizes="(max-width: 740px) 80vw, (max-width: 999px) 60vw, 425px"
                      alt="" 
                      src="{{ block.settings.image_child | image_url: width: block.settings.image_child.width }}" 
                      srcset="{%- if block.settings.image_child.width >= 3000 -%}{{ block.settings.image_child | image_url: width: 3000, crop: 'center' }} 3000w,{%- endif -%}
                          {{ block.settings.image_child | image_url }} {{ block.settings.image_child.width }}w"
                      src="{{ block.settings.image_child | image_url: width: 1500 }}"
                      height="{{ block.settings.image_child.height }}"
                      width="{{ block.settings.image_child.width }}">
                  {% else %}
                    {{ 'image' | placeholder_svg_tag: 'placeholder-svg' }}
                  {% endif %}
                </div>

              {%- when 'text-list' -%}
                <div class="newsletter-text-list text-left">
                  <h3 style="color: {{ block.settings.color_sp_heading }}" class="heading sp-heading fs-u2 mb-18" reveal="">
                    {{ block.settings.sp_heading }}
                  </h3>
                  <h2 style="color: {{ block.settings.color_heading }}" class="heading {{ block.settings.heading_size }} my-0" reveal="">
                    {{ block.settings.heading }}
                  </h2>
                  <p style="color: {{ block.settings.color_description }}" reveal="" class="mb-40 mt-23">
                    {{ block.settings.description }}
                  </p>
                  {% if block.settings.btn_text != blank %}
                  <div class="btn-more">
                    <a href="{{ block.settings.btn_link }}" class="button {{ block.settings.style_btn }}">
                      {{ block.settings.btn_text }}
                    </a>
                  </div>
                  {% endif %}   
                </div>

            {%- endcase -%}
          {%- endfor -%}
        </div>
      </div>
    </div>
  </ap-newsletter>
</section>

{% schema %}
{
  "name": "t:sections.newsletter.name",
  "tag": "section",
  "class": "section newsletter-section",
  "settings": [
    {
      "type": "select",
      "id": "setwidthout",
      "label": "Width Slideshow",
      "default": "container",
      "options": [
        {
          "value": "container",
          "label": "Box"
        },
        {
          "value": "container-fluid",
          "label": "Container Fluid"
        },
        {
          "value": "full",
          "label": "Full"
        }
      ]
    },
    {
      "type": "color",
      "id": "section_background",
      "default": "#ffffff ",
      "label": "t:sections.all.section_background.label"
    },
    {
      "type": "image_picker",
      "id": "background_image",
      "label": "t:sections.all.background_image.label"
    },
    {
      "type": "color",
      "id": "heading_color",
      "default": "#282828",
      "label": "t:sections.all.heading_color.label"
    },
    {
      "type": "color",
      "id": "text_color",
      "default": "#282828",
      "label": "t:sections.all.text_color.label"
    },
    {
      "type": "color",
      "id": "button_background",
      "default": "#405DE6 ",
      "label": "t:sections.all.button_background.label"
    },
    {
      "type": "color",
      "id": "button_color",
      "default": "#ffffff ",
      "label": "t:sections.all.button_color.label"
    },
    {
      "type": "color",
      "id": "background_button_hover",
      "default": "#648935 ",
      "label": "Background button hover"
    },
    {
      "type": "text",
      "id": "margin_desktop",
      "label": "t:sections.all.margin_desktop.label",
      "info": "t:sections.all.margin_desktop.info"
    },
    {
      "type": "text",
      "id": "margin_tablet",
      "label": "t:sections.all.margin_tablet.label",
      "info": "t:sections.all.margin_tablet.info"
    },
    {
      "type": "text",
      "id": "margin_mobile",
      "label": "t:sections.all.margin_mobile.label",
      "info": "t:sections.all.margin_mobile.info"
    },
    {
      "type": "text",
      "id": "padding_desktop",
      "label": "Padding desktop",
      "default": "0px 0px 0px 0px",
      "info": "Example: 0px 0px 0px 0px"
    },
    {
      "type": "text",
      "id": "padding_tablet",
      "label": "Padding tablet",
      "default": "0px 0px 0px 0px",
      "info": "Example: 0px 0px 0px 0px"
    },
    {
      "type": "text",
      "id": "padding_mobile",
      "label": "Padding mobile",
      "default": "0px 0px 0px 0px",
      "info": "Example: 0px 0px 0px 0px"
    },
    {
      "type": "text",
      "id": "border_width",
      "label": "Border width",
      "info": "Ex: 1px 1px 1px 1px"
    }
  ],
  "blocks": [
    {
      "type": "heading",
      "name": "t:sections.newsletter.blocks.heading.name",
      "limit": 1,
      "settings": [
        {
          "type": "liquid",
          "id": "heading",
          "default": "Subscribe to our emails",
          "label": "t:sections.newsletter.blocks.heading.settings.heading.label"
        },
        {
          "type": "liquid",
          "id": "description",
          "default": "Be the first to know about new collections and exclusive offers",
          "label": "t:sections.all.description.label"
        }
      ]
    },
    {
      "type": "paragraph",
      "name": "t:sections.newsletter.blocks.paragraph.name",
      "limit": 1,
      "settings": [
        {
          "type": "richtext",
          "id": "text",
          "default": "<p>Be the first to know about new collections and exclusive offers.</p>",
          "label": "t:sections.newsletter.blocks.paragraph.settings.paragraph.label"
        }
      ]
    },
    {
      "type": "image-child",
      "name": "Image child",
      "limit": 1,
      "settings": [
        {
          "type": "image_picker",
          "id": "image_child",
          "label": "Image child"
        }
      ]
    },
    {
      "type": "email_form",
      "name": "t:sections.newsletter.blocks.email_form.name",
      "settings": [
        {
          "type": "color",
          "id": "bg_newsletter",
          "default": "#fff",
          "label": "Background color"
        },
        {
          "type": "color",
          "id": "bg_input",
          "default": "#F4F3F0",
          "label": "Background input"
        },
        {
          "type": "color",
          "id": "color_input",
          "default": "#000",
          "label": "Color input"
        },
        {
          "type": "color",
          "id": "color_heading",
          "default": "#807667",
          "label": "Color Heading"
        },
        {
          "type": "color",
          "id": "color_des",
          "default": "#555555",
          "label": "Color description"
        },
        {
          "type": "liquid",
          "id": "heading",
          "default": "Subscribe to our emails",
          "label": "Heading"
        },
        {
          "type": "liquid",
          "id": "description",
          "default": "Be the first to know about new collections and exclusive offers",
          "label": "Description"
        },
        {
          "type": "text",
          "id": "text_input",
          "label": "Text Input"
        },
        {
          "type": "text",
          "id": "text_button",
          "label": "Text Button"
        },
        {
          "type": "select",
          "id": "text_align",
          "options": [
            {
              "value": "left",
              "label": "Left"
            },
            {
              "value": "center",
              "label": "Center"
            },
            {
              "value": "right",
              "label": "Right"
            }
          ],
          "default": "left",
          "label": "Text align"
        }
      ]
    },
    {
      "type": "text-list",
      "name": "Text List",
      "settings": [
        {
          "type": "text",
          "id": "sp_heading",
          "label": "SP Heading"
        },
        {
          "type": "color",
          "id": "color_sp_heading",
          "label": "Color SP Heading",
          "default": "#979797"
        },
        {
          "type": "text",
          "id": "heading",
          "label": "Heading"
        },
        {
          "type": "color",
          "id": "color_heading",
          "label": "Color Heading",
          "default": "#807667"
        },
        {
          "type": "select",
          "id": "heading_size",
          "options": [
            {
              "value": "h1",
              "label": "H1"
            },
            {
              "value": "h2",
              "label": "H2"
            },
            {
              "value": "h3",
              "label": "H3"
            },
            {
              "value": "h4",
              "label": "H4"
            },
            {
              "value": "h5",
              "label": "H5"
            },
            {
              "value": "h6",
              "label": "H6"
            },
            {
              "value": "p",
              "label": "P"
            }
          ],
          "default": "h3",
          "label": "t:sections.all.heading_size.label"
        },
        {
          "type": "liquid",
          "id": "description",
          "label": "HTML / Description"
        },
        {
          "type": "color",
          "id": "color_description",
          "label": "Color Description",
          "default": "#000"
        },
        {
          "type": "text",
          "id": "btn_text",
          "label": "Button Text"
        },
        {
          "type": "url",
          "id": "btn_link",
          "label": "Link"
        },
        {
          "type": "select",
          "id": "style_btn",
          "label": "Style Button",
          "default": "btn-base",
          "options": [
            {
              "value": "btn-base",
              "label": "Button Base"
            },
            {
              "value": "btn-outline",
              "label": "Button Out Line"
            },
            {
              "value": "btn-line",
              "label": "Button Line"
            },
            {
              "value": "btn-line-black",
              "label": "Button Line Black"
            }
          ]
        }
      ]
    },
    {
      "type": "@app"
    }
  ],
  "presets": [
    {
      "name": "t:sections.newsletter.presets.name",
      "blocks": [
        {
          "type": "heading"
        },
        {
          "type": "paragraph"
        },
        {
          "type": "email_form"
        }
      ]
    }
  ]
}
{% endschema %}
